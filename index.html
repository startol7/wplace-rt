<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>TePlace — Real World Map Conquest</title>

  <!-- Leaflet（先に読み込む：defer なし） -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <link rel="stylesheet" href="style.css" />

  <!-- 100vhハック：実画面高さを --vh に反映 -->
  <script>
    (function applyVH(){
      const set = () => {
        const h = (window.visualViewport?.height || window.innerHeight) * 0.01;
        document.documentElement.style.setProperty('--vh', h + 'px');
      };
      set();
      window.addEventListener('resize', set, {passive:true});
      window.visualViewport?.addEventListener?.('resize', set, {passive:true});
      window.addEventListener('orientationchange', set, {passive:true});
    })();
  </script>
</head>
<body>
  <!-- 薄いヘッダー -->
  <header class="floating-bar">
    <div class="brand">🌍 TePlace</div>
    <div class="spacer"></div>
    <label class="country-pill">
      <span class="label">Your country</span>
      <select id="countrySelect" aria-label="Your country"></select>
    </label>
    <button id="signBtn" class="pill-btn" type="button">Sign in</button>
  </header>

  <!-- 上：情報パネル -->
  <section class="info-panels panels-mobile-order">
    <details open>
      <summary>🏆 World Ranking</summary>
      <ul id="rankingList" class="ranking-list">
        <li>No data yet</li>
      </ul>
    </details>

    <details open>
      <summary>📊 Statistics</summary>
      <div class="stats">
        <div class="stat-row"><span>Total territories</span><strong id="statTotal">0</strong></div>
        <div class="stat-row"><span>My territories</span><strong id="statMine">0</strong></div>
        <div class="stat-row"><span>Online (approx)</span><strong id="statOnline">0</strong></div>
      </div>
    </details>

    <details open>
      <summary>🎨 Color & Tile size</summary>
      <div class="controls-box">
        <div class="row">
          <span class="row-label">Color</span>
          <input id="colorHex" class="mono" type="text" value="#ff4b4b" />
          <label class="color-chip"><input id="colorPicker" type="color" value="#ff4b4b" /></label>
        </div>

        <div class="row">
          <span class="row-label">Tile</span>
          <div class="seg">
            <button class="seg-btn" data-tile="0.005" type="button">0.005°</button>
            <button class="seg-btn" data-tile="0.001" type="button">0.001°</button>
            <button class="seg-btn active" data-tile="0.0005" type="button">0.0005°</button>
          </div>
        </div>

        <div class="row">
          <input id="tileCustom" class="mono" type="number" step="0.0001" value="0.0005" />
          <button id="tileApply" class="btn small" type="button">Apply</button>
        </div>
        <small class="note">1×1 only ・ Cooldown: <b>10s</b></small>
      </div>
    </details>
  </section>

  <!-- 下：地図（スマホでは常に下で表示） -->
  <main id="mapWrap" class="map-stick-bottom">
    <div id="map" role="region" aria-label="World map"></div>

    <!-- クールダウン -->
    <div id="cooldown" class="cooldown hidden" aria-live="polite">
      <div id="cooldownFill" class="bar"></div>
      <span id="cooldownText">0s</span>
    </div>
  </main>

  <script src="script.js"></script>
</body>
</html>